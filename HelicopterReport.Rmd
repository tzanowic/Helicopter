---
title: "HelicopterReport"
author: "Tristan Zanowic, Aureo Zanon"
date: "4/6/2023"
output:
  pdf_document:
    toc: yes
    toc_depth: '2'
---

```{r Front Matter, include=FALSE}
# clean up & set default chunk options
rm(list = ls())
knitr::opts_chunk$set(echo = FALSE)
# packages
library(tidyverse) 
library(mosaic)  
library(FrF2) # tools for design and analysis of fractional factorials
library(pid)
library(MASS)
library(rsm)
library(kableExtra)
```


# Project Description

Paper helicopters are a fun, creative way for child care programs to get children engaged with curiosity and building. Built using a single sheet of paper and other common supplies, these helicopters are designed in a near infinite number of ways in an attempt to gain the most air time. 

To determine the optimal paper helicopter specifications in lengthening flight time, a fractional factorial design is conducted along with a response surface experiment in this research. The goal is to analyze the effects of several variables within the helicopterâ€™s design to discover what factors lead to the longest flight time, while maintaining a budget of 60 helicopters. With this study, the results can hopefully help children build the best helicopter to stay in the air, keeping them intrigued and curious throughout their learning. 

## Research Questions


**Question 1:** What paper helicopter design factors lead to the longest flight time?

**Question 2:**  



## Variables

There are a total of six explanatory variables of interest in predicting flight time, from cutting dimensions such as wing length to add-ons like paper clips. Each variable has two levels to be analyzed (listed in the description column of the table below).

```{r}
#variable table
vartable = data.frame(Variable = c("Wing length","Body length","Body width","Paper clips","Folded wings","Folded body","Time"), Type = c("Explanatory","Explanatory","Explanatory","Explanatory","Explanatory","Explanatory", "Response"), Description = c("Length of wings (70mm or 120mm)", "Length of body (70mm or 120mm)", "Width of body (35mm or 50mm)", "No. of paper clips (0 or 2)", "Are wings folded (no or yes)", "Is the body folded (no or yes)", "Time in air (seconds)"))
   

vartable %>%
  kbl(caption = "Variable Table") %>%
  kable_classic(full_width = F, html_font = "Cambria") 
```


# Screening Experiment

To begin analyzing the six variables of interest, a fractional factorial design is used to screen our predictors. To identify the key variables at play in lengthening paper helicopter flight time, a resolution VI factorial design is used, equating to 32 screening runs. Within these runs, helicopters were dropped from approximately 15 feet with variations in design specifications across each trial, and the time in air was recorded. One observation that was noted during these trials was the common appearance of tumbling, which seemed to occur more often when paper clips were not used. Regardless, no obvious trends related to flight time were observed during the tests.

From these results of these 32 runs, a model can be fitted including our six variables of interest, along with every 2-way interaction. To reduce this complex model, step-wise backwards selection was used to drop the least significant terms, and a summary of this model can be seen in the table below. As seen in this table, the most significant terms appear to be folded body and paper clips, with both having a negative effect on flight time. Many interaction terms (that include folded body and paper clips) being significant as well.

```{r}
HeliDesign <- read.csv("fracfact.csv")
#store then omit center points 
CP <- HeliDesign[33:36,]
HeliDesign <- HeliDesign[1:32,]


# main effects and all 2-way interactions
HeliMod_2way <- lm(time ~(.)^2, data = HeliDesign)

# looking for contributing effects
#pid::paretoPlot(HeliMod_2way)
# reduced model after stepwise backwards selection (alpha = 0.1)**
step <- stepAIC(HeliMod_2way, direction = "both", trace = FALSE)

HeliMod_reduced <- step
sumHeli <- summary(HeliMod_reduced)
screeningtable <- as.data.frame(round(sumHeli$coefficients,3))
names(screeningtable) <- c("Coefficient","Standard Error", "T-Test Stat", "P-value")

screeningtable %>%
  kbl(caption = "Reduced Fractional Factorial Model Results") %>%
  kable_classic(full_width = F, html_font = "Cambria") 
```

The pareto plot below further emphasizes these effects, showcasing which variables (including interactions) have the greatest effect (both negative and positive) on flight time. In agreement with the model results above, having a folded body had the largest effect on flight time, as the presence of a folded body negatively effected time in the air. 

```{r}
paretoPlot(HeliMod_reduced)
```


```{r}
# effect plots
MEPlot(HeliMod_reduced) # main effects
IAPlot(HeliMod_reduced) # interactions
cubePlot(HeliMod_reduced, eff1 = "winglength", eff2 = "paperclips", 
         eff3 = "foldedbody",
         main = "Cube Plot for Distance to Optimal Helicopter")
```

# Response Surface Experiment

```{r}
##boxbehnke design
bb_design_1 <- bbd(
  k  = 3,            # Number of factors,
  n0 = 4,            # Number of center points,
  block = FALSE,     # Consider blocks or not in the design 
  randomize = FALSE)

names <-c("foldedbody","paperclips","winglength")

designbb <- bb_design_1[,3:5]
setnames(designbb,names)
#fwrite(designbb,"~/Desktop/PSU/SeniorYear/Spring Semester/STAT470W/HeliFFD/BBDesign.csv")

#response surface design
HeliD <- read.csv("./HeliFFD/BBDesign.csv")
model<-rsm(time~ FO(foldedbody,paperclips,winglength), data=HeliD) 
summary(model)

# countour plots
par(mfrow=c(1,3))
contour(model,~foldedbody+paperclips+winglength, 
        image=TRUE, at=summary(model$canonical$xs))

dev.off()

persp(model, ~ foldedbody + paperclips, image = TRUE,
      at = c(summary(model)$canonical$xs, Block="B2"),
      theta=30,zlab="Time",col.lab=33,contour="colors")
persp(model, ~ winglength + paperclips, image = TRUE,
      at = c(summary(model)$canonical$xs, Block="B2"),
      theta=30,zlab="Time",col.lab=33,contour="colors")
persp(model, ~ winglength + foldedbody, image = TRUE,
      at = c(summary(model)$canonical$xs, Block="B2"),
      theta=30,zlab="Time",col.lab=33,contour="colors")

#optimal design for longest time in the air
steepest(model)

```

# Recommendations 

*Succinct response to each question laid out in 1.2.  This a much shorter version of section 3, and focuses on conclusions rather than the analyses.*

**Question 1:**  

**Question 2:**  

*(all research questions in 1.1 and/or statistical question in 1.2 should be addressed, in the same order)*

## Considerations

- User error (timing, designing)

# Technical Appendix  

*Detailed information and a copy of code and or software results.  Additional graphs and supporting figures may also be placed in the appendix.*


### R Script
```{r ref.label=c('Front Matter', 'Data Cleaning', 'MPG summary', 'EDA-scatterplot'), echo=TRUE, eval=FALSE}
# Reprinted code chunks used previously for analysis
```